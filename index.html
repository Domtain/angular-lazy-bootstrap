<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>angular-lazy-bootstrap by rajeshsegu</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>angular-lazy-bootstrap</h1>
        <h2>Bootstarp angular app after fetching initial config/data </h2>
        <a href="https://github.com/rajeshsegu/angular-lazy-bootstrap" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a id="angular-lazy-bootstrap" class="anchor" href="#angular-lazy-bootstrap" aria-hidden="true"><span class="octicon octicon-link"></span></a>angular-lazy-bootstrap</h1>

<p><a href="https://travis-ci.org/rajeshsegu/angular-lazy-bootstrap"><img src="https://travis-ci.org/rajeshsegu/angular-lazy-bootstrap.svg?branch=master" alt="Build Status"></a>
<a href="https://gitter.im/rajeshsegu/angular-lazy-bootstrap"><img src="https://badges.gitter.im/Join%20Chat.svg" alt="Gitter chat"></a></p>

<p>This elegant piece of code would help any Angular based single page web application to ideally load the initial configuration, global variables, server flags and UI flags before initializing the UI. It deffers the Angular bootstrapping process until we resolve all the chained promises. </p>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>Instead of using the <code>ng-app</code> directive or <code>angular.bootstrap()</code>, use the <code>angular.lazy().resolve().bootstrap()</code> to initialize your app.</p>

<h3>
<a id="simple-case" class="anchor" href="#simple-case" aria-hidden="true"><span class="octicon octicon-link"></span></a>Simple Case</h3>

<div class="highlight highlight-js"><pre>
angular.lazy(<span class="pl-s1"><span class="pl-pds">"</span>demoApp<span class="pl-pds">"</span></span>)
  .resolve([<span class="pl-s1"><span class="pl-pds">'</span>$http<span class="pl-pds">'</span></span>, <span class="pl-st">function</span> (<span class="pl-vpf">$http</span>) {
      <span class="pl-k">return</span> $http.get(<span class="pl-s1"><span class="pl-pds">'</span>/demo/api/config.json<span class="pl-pds">'</span></span>)
          .then(<span class="pl-st">function</span> (<span class="pl-vpf">resp</span>) {
              <span class="pl-s3">window</span>.app.config <span class="pl-k">=</span> resp.<span class="pl-sc">data</span>;
          });
      }])
  .bootstrap();
</pre></div>

<p>In this code sample, <code>demoApp</code> would be lazily initialized once you fetch the config from the server and make it available to the angular app though global variables or any angular service as designed by the application.</p>

<h3>
<a id="multiple-dependecies-case" class="anchor" href="#multiple-dependecies-case" aria-hidden="true"><span class="octicon octicon-link"></span></a>Multiple Dependecies Case</h3>

<div class="highlight highlight-js"><pre>
angular.lazy(<span class="pl-s1"><span class="pl-pds">"</span>demoApp<span class="pl-pds">"</span></span>)
  .resolve([<span class="pl-s1"><span class="pl-pds">'</span>$http<span class="pl-pds">'</span></span>, <span class="pl-st">function</span> (<span class="pl-vpf">$http</span>) {
     <span class="pl-k">return</span> $http.get(<span class="pl-s1"><span class="pl-pds">'</span>/demo/api/config.json<span class="pl-pds">'</span></span>)
        .then(<span class="pl-st">function</span> (<span class="pl-vpf">resp</span>) {
              <span class="pl-s3">window</span>.app.config <span class="pl-k">=</span> resp.<span class="pl-sc">data</span>;
           }, <span class="pl-st">function</span> (<span class="pl-vpf">err</span>){
               angular.element(<span class="pl-s1"><span class="pl-pds">'</span>#error<span class="pl-pds">'</span></span>).show();
           });
   }])
  .resolve([<span class="pl-s1"><span class="pl-pds">'</span>$http<span class="pl-pds">'</span></span>, <span class="pl-st">function</span> (<span class="pl-vpf">$http</span>) {
     <span class="pl-k">return</span> $http.get(<span class="pl-s1"><span class="pl-pds">'</span>/demo/api/config-next.json<span class="pl-pds">'</span></span>)
        .then(<span class="pl-st">function</span> (<span class="pl-vpf">resp</span>) {
             <span class="pl-s3">window</span>.app.config <span class="pl-k">=</span> resp.<span class="pl-sc">data</span>;
        }, <span class="pl-st">function</span> (<span class="pl-vpf">err</span>){
             angular.element(<span class="pl-s1"><span class="pl-pds">'</span>#error<span class="pl-pds">'</span></span>).show();
        });
   }])
  .resolve([<span class="pl-s1"><span class="pl-pds">'</span>$q<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>$timeout<span class="pl-pds">'</span></span>, <span class="pl-st">function</span> (<span class="pl-vpf">$q</span>, <span class="pl-vpf">$timeout</span>) {
       <span class="pl-s">var</span> deferred <span class="pl-k">=</span> $q.<span class="pl-sc">defer</span>();
       $timeout(<span class="pl-st">function</span> () {
           <span class="pl-s3">window</span>.app.const <span class="pl-k">=</span> <span class="pl-s1"><span class="pl-pds">'</span>My Constant<span class="pl-pds">'</span></span>;
           deferred.resolve();
       }, <span class="pl-c1">2000</span>);
       <span class="pl-k">return</span> deferred.promise;
  }])
  .bootstrap();
</pre></div>

<p>In this code sample, <code>demoApp</code> would be lazily initialized once resolve each promise in the given order. In this case, it fetches initial config and then fetches a next config for partner website and then has a timeout resolve ( just an example ) before it boostraps the actual angular application. </p>

<p><strong>Note</strong> You can handle errors individually per promise or globally ( below example )</p>

<h3>
<a id="error-case" class="anchor" href="#error-case" aria-hidden="true"><span class="octicon octicon-link"></span></a>Error Case</h3>

<div class="highlight highlight-js"><pre>
angular.lazy(<span class="pl-s1"><span class="pl-pds">"</span>demoApp<span class="pl-pds">"</span></span>)
  .resolve([<span class="pl-s1"><span class="pl-pds">'</span>$q<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>$timeout<span class="pl-pds">'</span></span>, <span class="pl-st">function</span> (<span class="pl-vpf">$q</span>, <span class="pl-vpf">$timeout</span>) {
       <span class="pl-s">var</span> deferred <span class="pl-k">=</span> $q.<span class="pl-sc">defer</span>();
       $timeout(<span class="pl-st">function</span> () {
           deferred.reject(<span class="pl-s1"><span class="pl-pds">'</span>EXCEPTION<span class="pl-pds">'</span></span>);
       }, <span class="pl-c1">2000</span>);
       <span class="pl-k">return</span> deferred.promise;
    }])
   .loading(<span class="pl-st">function</span>(){
       angular.element(<span class="pl-s1"><span class="pl-pds">'</span>#loading<span class="pl-pds">'</span></span>).show();
   })
   <span class="pl-s3">.error</span>(<span class="pl-st">function</span>(){
       angular.element(<span class="pl-s1"><span class="pl-pds">'</span>#error<span class="pl-pds">'</span></span>).show();
   })
   .done(<span class="pl-st">function</span>() {
       angular.element(<span class="pl-s1"><span class="pl-pds">'</span>#loading<span class="pl-pds">'</span></span>).hide();
   })
   .bootstrap();
</pre></div>

<p>In this code sample, <code>demoApp</code> would not load since the promise is rejected. We have an <code>error()</code> handler that gives UI a chance to handle error initializing the app or to start a new flow.</p>

<h3>
<a id="more-control" class="anchor" href="#more-control" aria-hidden="true"><span class="octicon octicon-link"></span></a>More Control</h3>

<div class="highlight highlight-js"><pre>
angular.lazy(<span class="pl-s1"><span class="pl-pds">"</span>demoApp<span class="pl-pds">"</span></span>)
  .resolve([<span class="pl-s1"><span class="pl-pds">'</span>$http<span class="pl-pds">'</span></span>, <span class="pl-st">function</span> (<span class="pl-vpf">$http</span>) {
      <span class="pl-k">return</span> $http.get(<span class="pl-s1"><span class="pl-pds">'</span>/demo/api/config.json<span class="pl-pds">'</span></span>)
          .then(<span class="pl-st">function</span> (<span class="pl-vpf">resp</span>) {
              <span class="pl-s3">window</span>.app.config <span class="pl-k">=</span> resp.<span class="pl-sc">data</span>;
          });
      }])
   .loading(<span class="pl-st">function</span>(){
       angular.element(<span class="pl-s1"><span class="pl-pds">'</span>#loading<span class="pl-pds">'</span></span>).show();
   })
   <span class="pl-s3">.error</span>(<span class="pl-st">function</span>(){
       angular.element(<span class="pl-s1"><span class="pl-pds">'</span>#error<span class="pl-pds">'</span></span>).show();
   })
   .done(<span class="pl-st">function</span>() {
       angular.element(<span class="pl-s1"><span class="pl-pds">'</span>#loading<span class="pl-pds">'</span></span>).hide();
   })
   .bootstrap();
</pre></div>

<p>This framework allows you to tap into different states during initializing the angular app, </p>

<p><code>loading()</code>: Gives control for the UI on loading phase ( promises are resolving during this state ) </p>

<p><code>error()</code>  : Gives control if an error occurs ( if any of the promise results in failure )</p>

<p><code>done()</code>   : Gives control once the app is initialized</p>

<h3>
<a id="demo" class="anchor" href="#demo" aria-hidden="true"><span class="octicon octicon-link"></span></a>DEMO</h3>

<p>I have included a node webserver to make this easy to try:</p>

<pre><code>git clone https://github.com/rajeshsegu/angular-lazy-bootstrap.git
npm install
node webserver.js
[ access server at http://localhost:5050/ ]
</code></pre>

<p>You can try out working samples at:</p>

<p><code>Simple Case</code>   : http://localhost:5050/demo/simple.html</p>

<p><code>Multi Case</code>    : http://localhost:5050/demo/multi.html</p>

<p><code>Error Case</code>    : http://localhost:5050/demo/error.html</p>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>License</h2>

<p><a href="http://opensource.org/licenses/MIT">MIT</a> © Rajesh Segu</p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/rajeshsegu/angular-lazy-bootstrap/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/rajeshsegu/angular-lazy-bootstrap/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/rajeshsegu/angular-lazy-bootstrap"></a> is maintained by <a href="https://github.com/rajeshsegu">rajeshsegu</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
